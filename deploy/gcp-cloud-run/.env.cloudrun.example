#=====================================================================#
#          Scentier AI Platform - Cloud Run Configuration            #
#=====================================================================#
# GCP Cloud Run deployment configuration for internal SaaS
# Copy this to .env.cloudrun and fill in the values
#=====================================================================#

#==================================================#
#               Server Configuration               #
#==================================================#

# Cloud Run automatically sets PORT (default 8080)
# HOST must be 0.0.0.0 for Cloud Run
HOST=0.0.0.0

# Your Cloud Run service URL (set after first deployment)
# Example: https://scentier-ai-xxxxx-an.a.run.app
DOMAIN_CLIENT=https://your-cloudrun-service-url.run.app
DOMAIN_SERVER=https://your-cloudrun-service-url.run.app

# Trust Cloud Run's load balancer
TRUST_PROXY=1

# Disable search engine indexing (internal SaaS)
NO_INDEX=true

#==================================================#
#            Database Configuration                #
#==================================================#

# MongoDB Atlas (Recommended for Cloud Run)
# Create a cluster at https://www.mongodb.com/cloud/atlas
# Use the connection string from Atlas
MONGO_URI=mongodb+srv://<username>:<password>@<cluster>.mongodb.net/ScentierAI?retryWrites=true&w=majority

# MongoDB Connection Pool Settings (optimized for Cloud Run)
MONGO_MAX_POOL_SIZE=10
MONGO_MIN_POOL_SIZE=1
MONGO_MAX_CONNECTING=5
MONGO_MAX_IDLE_TIME_MS=60000

#==================================================#
#                Redis (Optional)                  #
#==================================================#

# Cloud Memorystore for Redis (if using)
# Note: Requires VPC Connector for Cloud Run
# USE_REDIS=true
# REDIS_URI=redis://10.0.0.3:6379

# For Redis with TLS (Cloud Memorystore with in-transit encryption)
# REDIS_URI=rediss://10.0.0.3:6379
# REDIS_CA=/secrets/redis-ca.pem

# Use Cloud Run revision as Redis key prefix for cache isolation
REDIS_KEY_PREFIX_VAR=K_REVISION

#==================================================#
#                    Search                        #
#==================================================#

# Option 1: Self-hosted Meilisearch on Cloud Run (separate service)
SEARCH=true
MEILI_NO_ANALYTICS=true
MEILI_HOST=https://meilisearch-service-xxxxx.run.app
MEILI_MASTER_KEY=your-secure-meilisearch-master-key

# Option 2: Disable search if not using Meilisearch
# SEARCH=false

#==================================================#
#               Security & Auth                    #
#==================================================#

# Generate secure keys: openssl rand -hex 32
CREDS_KEY=your-32-byte-hex-key-here
CREDS_IV=your-16-byte-hex-iv-here
JWT_SECRET=your-jwt-secret-key-here
JWT_REFRESH_SECRET=your-jwt-refresh-secret-here

# Session Configuration
SESSION_EXPIRY=900000
REFRESH_TOKEN_EXPIRY=604800000

#==================================================#
#           Registration & Login                   #
#==================================================#

# For internal SaaS, typically disable public registration
ALLOW_EMAIL_LOGIN=true
ALLOW_REGISTRATION=false
ALLOW_SOCIAL_LOGIN=true
ALLOW_SOCIAL_REGISTRATION=false
ALLOW_PASSWORD_RESET=true
ALLOW_UNVERIFIED_EMAIL_LOGIN=false

#==================================================#
#     Google Cloud Identity / IAP Integration      #
#==================================================#

# Use Google OAuth for internal authentication
GOOGLE_CLIENT_ID=your-google-oauth-client-id
GOOGLE_CLIENT_SECRET=your-google-oauth-client-secret
GOOGLE_CALLBACK_URL=/oauth/google/callback

# OpenID Connect (for Google Workspace / Cloud Identity)
# OPENID_CLIENT_ID=your-google-oauth-client-id
# OPENID_CLIENT_SECRET=your-google-oauth-client-secret
# OPENID_ISSUER=https://accounts.google.com
# OPENID_CALLBACK_URL=/oauth/openid/callback
# OPENID_SCOPE="openid profile email"
# OPENID_AUTO_REDIRECT=true

#==================================================#
#                 AI Endpoints                     #
#==================================================#

# OpenAI
OPENAI_API_KEY=user_provided
# OPENAI_MODELS=gpt-4o,gpt-4o-mini,gpt-4-turbo,gpt-4,gpt-3.5-turbo

# Anthropic
ANTHROPIC_API_KEY=user_provided

# Google AI (Gemini)
GOOGLE_KEY=user_provided

# For Vertex AI integration
# GOOGLE_LOC=asia-northeast1

#==================================================#
#           File Storage (GCS)                     #
#==================================================#

# Google Cloud Storage for file uploads
# Create a bucket: gsutil mb gs://your-bucket-name
# Set in librechat.yaml: fileStrategy: "gcs"

# GCS_BUCKET_NAME=your-gcs-bucket-name
# Note: Use Workload Identity for authentication (no keys needed)

# Alternative: AWS S3 Compatible Storage
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_REGION=asia-northeast1
# AWS_BUCKET_NAME=your-bucket-name

#==================================================#
#                     RAG                          #
#==================================================#

# RAG API Service URL (separate Cloud Run service)
# RAG_API_URL=https://rag-api-service-xxxxx.run.app

# Embeddings Configuration
# EMBEDDINGS_PROVIDER=openai
# EMBEDDINGS_MODEL=text-embedding-3-small
# RAG_OPENAI_API_KEY=your-openai-api-key

#==================================================#
#                   Logging                        #
#==================================================#

# Enable JSON logging for Cloud Logging
CONSOLE_JSON=true

# Debug logging (disable in production)
DEBUG_LOGGING=false
DEBUG_CONSOLE=false

#==================================================#
#                 UI Configuration                 #
#==================================================#

APP_TITLE=Scentier AI Platform
HELP_AND_FAQ_URL=https://your-internal-docs-url.com

# Disable shared links for internal SaaS
ALLOW_SHARED_LINKS=false
ALLOW_SHARED_LINKS_PUBLIC=false

#==================================================#
#              Rate Limiting                       #
#==================================================#

LIMIT_CONCURRENT_MESSAGES=true
CONCURRENT_MESSAGE_MAX=3

LIMIT_MESSAGE_IP=true
MESSAGE_IP_MAX=60
MESSAGE_IP_WINDOW=1

LIMIT_MESSAGE_USER=true
MESSAGE_USER_MAX=60
MESSAGE_USER_WINDOW=1

#==================================================#
#         Email Configuration (Optional)          #
#==================================================#

# Gmail SMTP (for password reset emails)
# EMAIL_SERVICE=gmail
# EMAIL_HOST=smtp.gmail.com
# EMAIL_PORT=587
# EMAIL_ENCRYPTION=starttls
# EMAIL_USERNAME=your-email@your-domain.com
# EMAIL_PASSWORD=your-app-specific-password
# EMAIL_FROM_NAME=Scentier AI Platform
# EMAIL_FROM=noreply@your-domain.com

#==================================================#
#     Additional Security (Production)            #
#==================================================#

# Content moderation
OPENAI_MODERATION=false
BAN_VIOLATIONS=true
BAN_DURATION=7200000
BAN_INTERVAL=20

# Static file caching
# STATIC_CACHE_MAX_AGE=172800
# STATIC_CACHE_S_MAX_AGE=86400
